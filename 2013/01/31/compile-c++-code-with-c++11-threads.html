<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Fabrice Leal : /dev/random &gt; /dev/null" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <title>Fabrice Leal</title>
  </head>

  <body>


      
    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <!--<a id="forkme_banner" href="https://github.com/fabriceleal">View on GitHub</a>-->

          <h1 id="project_title">Fabrice Leal</h1>
          <h2 id="project_tagline">cat /dev/random > /dev/null<!--/dev/random &gt; /dev/null--></h2>

	  <div class="menu">
	    <div class="menu_row">
	      <a href="/index.html" class="menu_bt first">Home</a>
	      <a href="/projects.html" class="menu_bt">Projects</a>
	      <!--<a href="github.html" class="menu_bt">Github</a>-->
	      <a href="/blog.html" class="menu_bt">Blog</a>
	      <a href="/contacts.html" class="menu_bt last">Contacts</a>
	    </div>
	  </div>

	</header>
	
    </div>


      <!-- CONTENT GOES HERE -->
      <div id="main_content_wrap" class="outer">
	<section id="main_content" class="inner">
	  
<!--	<div class="inner" style="background: #fff; float: right; ">	  
	  <div>Linkedin</div>
	  <div>Github</div>
	  <div>Coderbits</div>
	  <div>Twitter</div>
	</div>-->

	
	  <h1 id='compile_c_code_with_c11_threads'>Compile C++ code with C++11 threads</h1>

<p>Consider the following code, which uses the C++11 (used to be known as C++0x) thread library:</p>

<pre><code>#include &lt;iostream&gt;
#include &lt;thread&gt;

using namespace std;

void hello_world()
{
  cout &lt;&lt; &quot;Hello from thread!\n&quot;;
}

int main()
{
  thread t(hello_world);
  t.join();
  return 0;
}</code></pre>

<p>How can we get this to work? If we compile it with:</p>

<pre><code>g++ bare.cpp -o bare</code></pre>

<p>We&#8217;ll get something like:</p>

<pre><code>/usr/include/c++/4.5/bits/c++0x_warning.h:31:2: error: #error This file requires compiler and library support for the upcoming ISO C++ standard, C++0x. This support is currently experimental, and must be enabled with the -std=c++0x or -std=gnu++0x compiler options.</code></pre>

<p>&#8230; and maybe something about the <code>thread</code> type used in the code:</p>

<pre><code>error: ‘thread’ was not declared in this scope</code></pre>

<p>So we add the <code>std=c++0x</code> &#8230;</p>

<pre><code>g++ bare.cpp -std=c++0x -o bare</code></pre>

<p>No errors during compilation, but when we try to execute <code>bare</code>&#8230;</p>

<pre><code>$ ./bare
terminate called after throwing an instance of &#39;std::system_error&#39;
  what():  
Aborted</code></pre>

<p>&#8230; oops. We have to link this against the operating system&#8217;s implementation of threads. In linux, this is the <code>libpthread</code> library. The winning command is:</p>

<pre><code>g++ bare.cpp -std=c++0x -lpthread -o bare</code></pre>

<p>and then:</p>

<pre><code>$ ./bare
Hello from thread!</code></pre>
	

	</section>

      </div>

      

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
      </footer>
    </div>
  


                <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-34655314-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>



  </body>
</html>
